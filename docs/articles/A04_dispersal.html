<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="metaRange">
<title>04: Dispersal • metaRange</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="04: Dispersal">
<meta property="og:description" content="metaRange">
<meta property="og:image" content="https://metaRange.github.io/metaRange/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">metaRange</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A01_intro.html">01: Introduction to metaRange</a>
    <a class="dropdown-item" href="../articles/A02_multiple_species.html">02: Multiple species</a>
    <a class="dropdown-item" href="../articles/A03_niche_suitability.html">03: Niche suitability</a>
    <a class="dropdown-item" href="../articles/A04_dispersal.html">04: Dispersal</a>
    <a class="dropdown-item" href="../articles/A05_species_interactions.html">05: Species interactions</a>
    <a class="dropdown-item" href="../articles/A06_metabolic_scaling.html">06: Metabolic scaling</a>
    <a class="dropdown-item" href="../articles/A07_age_structured_populations.html">07: Age structured populations</a>
    <a class="dropdown-item" href="../articles/A08_advanced_options.html">08: Advanced options</a>
    <a class="dropdown-item" href="../articles/A09_troubleshooting_and_caveats.html">09: Troubleshooting / caveats</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/metaRange/metaRange/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>04: Dispersal</h1>
                        <h4 data-toc-skip class="author">Fallert, S. and
Cabral, J.S.</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/metaRange/metaRange/blob/HEAD/vignettes/A04_dispersal.Rmd" class="external-link"><code>vignettes/A04_dispersal.Rmd</code></a></small>
      <div class="d-none name"><code>A04_dispersal.Rmd</code></div>
    </div>

    
    
<p>Dispersal is a key process in the life cycle of many species and can
have a large impact on the population dynamics and the ability of a
species to survive and adapt to a changing environment.
<code>metaRange</code> allows the user to simulate dispersal in two
different ways using the <code><a href="../reference/dispersal.html">dispersal()</a></code> function, which are
described in the following sections.</p>
<p>Since metaRange is not an individual based model it uses the concept
of a dispersal kernel to simulate dispersal for each population. If one
is not familiar with this topic, a good introduction is “Nathan, Klein,
Robledo-Arnuncio, &amp; Revilla (2012) Dispersal kernels: review” (Ref.
1).</p>
<p>To also give a short explanation here: A dispersal kernel is
basically a matrix that describes how likely it is for an individual of
a source population to move to its surrounding habitat. Since this is a
probability distribution, this dispersal kernel can be multiplied with
each cell of the abundance matrix to get the new abundance of the
species in each cell after dispersal. In other scientific fields this
process is known as convolution and is for example often used in a
similar form in image processing and especially when “blurring” an
image.</p>
<p>We can use the function <code><a href="../reference/calculate_dispersal_kernel.html">calculate_dispersal_kernel()</a></code> to
create such a dispersal kernel. This function creates a matrix that has
<code>max_dispersal_dist</code> rows and columns on both sides of the
source cell and expects another function as input that it calls for each
of those cells with the distance from the source cell as an argument.
This may sound complicated but the code is very short if we use the
built-in <code>negative_exponential_function</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_dispersal_distance</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">mean_dispersal_distance</span> <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="va">dispersal_kernel</span> <span class="op">=</span> <span class="fu">metaRange</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_dispersal_kernel.html">calculate_dispersal_kernel</a></span><span class="op">(</span></span>
<span>    max_dispersal_dist <span class="op">=</span> <span class="va">max_dispersal_distance</span>, <span class="co"># units: grid cells</span></span>
<span>    kfun <span class="op">=</span> <span class="fu">metaRange</span><span class="fu">::</span><span class="va"><a href="../reference/negative_exponential_function.html">negative_exponential_function</a></span>, <span class="co"># this function calculates the kernel values</span></span>
<span>    mean_dispersal_dist <span class="op">=</span> <span class="va">mean_dispersal_distance</span> <span class="co"># this is passed to the kfun</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can plot the kernel to get a better understanding of what it looks
like. As you can see in the plot, the dispersal kernel is symmetrical
around the source cell and the probability of dispersal decreases with
the distance from the source cell. The sum of all values in the kernel
is 1, which means that the total abundance of the species is conserved
during dispersal.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>        <span class="va">dispersal_kernel</span>,</span>
<span>        extent <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span></span>
<span>            <span class="op">-</span><span class="va">max_dispersal_distance</span>, <span class="va">max_dispersal_distance</span>,</span>
<span>            <span class="op">-</span><span class="va">max_dispersal_distance</span>, <span class="va">max_dispersal_distance</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"Dispersal probability"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="A04_dispersal_files/figure-html/plot_kernel-1.png" alt="Figure 1: Example dispersal kernel for a negative exponential function" width="700"><p class="caption">
Figure 1: Example dispersal kernel for a negative exponential function
</p>
</div>
<p>While the assumption of dispersal via such a static kernel is an
often used simplification (i.e. the same kernel is applied to every
population), it is not always appropriate. For many species, dispersal
is not solely random, but directed towards a specific target or
influenced by other external factors. To allow simulations that include
this, the <code><a href="../reference/dispersal.html">dispersal()</a></code> function gives the user the option to
supply a third argument, <code>weights</code>, which is used to
redistribute the individuals within the dispersal kernel. If supplied,
the weights need to be a matrix of the same dimensions as the
environment and the values should be in the range of
<code>[0-1]</code>.</p>
<p>In this example we use <code><a href="../reference/calculate_suitability.html">calculate_suitability()</a></code> to create
a matrix that represent a general habitat suitability and use it as
weights, which would correspond to an ecological meaning of “individuals
moving towards a more suitable habitat during dispersal, if they have
the ability to perceive and reach it”.</p>
<div class="section level2">
<h2 id="basic-setup">Basic setup<a class="anchor" aria-label="anchor" href="#basic-setup"></a>
</h2>
<p>First, we load the necessary packages and create an example
landscape.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://metaRange.github.io/metaRange/">metaRange</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; metaRange version: 1.1.4</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.55</span></span>
<span><span class="fu"><a href="../reference/set_verbosity.html">set_verbosity</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raster_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/elev.tif"</span>, package <span class="op">=</span> <span class="st">"terra"</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">raster_file</span><span class="op">)</span></span>
<span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">r</span>, center <span class="op">=</span> <span class="cn">FALSE</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span><span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">temperature</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">landscape</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/sds.html" class="external-link">sds</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temperature"</span><span class="op">)</span></span></code></pre></div>
<p>Then we set up the basic simulation with two identical species.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_simulation.html">create_simulation</a></span><span class="op">(</span><span class="va">landscape</span><span class="op">)</span></span>
<span><span class="co">#&gt; number of time steps: 10</span></span>
<span><span class="co">#&gt; time step layer mapping: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</span></span>
<span><span class="co">#&gt; added environment</span></span>
<span><span class="co">#&gt; class       : SpatRasterDataset </span></span>
<span><span class="co">#&gt; subdatasets : 1 </span></span>
<span><span class="co">#&gt; dimensions  : 90, 95 (nrow, ncol)</span></span>
<span><span class="co">#&gt; nlyr        : 10 </span></span>
<span><span class="co">#&gt; resolution  : 0.008333333, 0.008333333  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 5.741667, 6.533333, 49.44167, 50.19167  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory </span></span>
<span><span class="co">#&gt; names       : temperature</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; created simulation: simulation_a5c7aca</span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="fu">add_species</span><span class="op">(</span><span class="st">"species_1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; adding species</span></span>
<span><span class="co">#&gt; name: species_1</span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="fu">add_species</span><span class="op">(</span><span class="st">"species_2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; adding species</span></span>
<span><span class="co">#&gt; name: species_2</span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="fu">add_traits</span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species_1"</span>, <span class="st">"species_2"</span><span class="op">)</span>,</span>
<span>    abundance <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    climate_suitability <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    reproduction_rate <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    carrying_capacity <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; adding traits:</span></span>
<span><span class="co">#&gt; [1] "abundance"           "climate_suitability" "reproduction_rate"  </span></span>
<span><span class="co">#&gt; [4] "carrying_capacity"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; to species:</span></span>
<span><span class="co">#&gt; [1] "species_1" "species_2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="fu">add_traits</span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species_1"</span>, <span class="st">"species_2"</span><span class="op">)</span>,</span>
<span>    population_level <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    max_temperature <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    optimal_temperature <span class="op">=</span> <span class="fl">288</span>,</span>
<span>    min_temperature <span class="op">=</span> <span class="fl">280</span>,</span>
<span>    dispersal_kernel <span class="op">=</span> <span class="fu"><a href="../reference/calculate_dispersal_kernel.html">calculate_dispersal_kernel</a></span><span class="op">(</span></span>
<span>        max_dispersal_dist <span class="op">=</span> <span class="fl">7</span>,</span>
<span>        kfun <span class="op">=</span> <span class="va">negative_exponential_function</span>,</span>
<span>        mean_dispersal_dist <span class="op">=</span> <span class="fl">4</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; adding traits:</span></span>
<span><span class="co">#&gt; [1] "max_temperature"     "optimal_temperature" "min_temperature"    </span></span>
<span><span class="co">#&gt; [4] "dispersal_kernel"</span></span>
<span><span class="co">#&gt; to species:</span></span>
<span><span class="co">#&gt; [1] "species_1" "species_2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="fu">add_process</span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species_1"</span>, <span class="st">"species_2"</span><span class="op">)</span>,</span>
<span>    process_name <span class="op">=</span> <span class="st">"calculate_suitability"</span>,</span>
<span>    process_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">climate_suitability</span> <span class="op">&lt;-</span></span>
<span>            <span class="fu"><a href="../reference/calculate_suitability.html">calculate_suitability</a></span><span class="op">(</span></span>
<span>                <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">max_temperature</span>,</span>
<span>                <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">optimal_temperature</span>,</span>
<span>                <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">min_temperature</span>,</span>
<span>                <span class="va">self</span><span class="op">$</span><span class="va">sim</span><span class="op">$</span><span class="va">environment</span><span class="op">$</span><span class="va">current</span><span class="op">$</span><span class="va">temperature</span></span>
<span>            <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    execution_priority <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; adding process: calculate_suitability</span></span>
<span><span class="co">#&gt; to species:</span></span>
<span><span class="co">#&gt; [1] "species_1" "species_2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="fu">add_process</span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species_1"</span>, <span class="st">"species_2"</span><span class="op">)</span>,</span>
<span>    process_name <span class="op">=</span> <span class="st">"reproduction"</span>,</span>
<span>    process_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">abundance</span> <span class="op">&lt;-</span></span>
<span>            <span class="fu"><a href="../reference/ricker_reproduction_model.html">ricker_reproduction_model</a></span><span class="op">(</span></span>
<span>                <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">abundance</span>,</span>
<span>                <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">reproduction_rate</span> <span class="op">*</span> <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">climate_suitability</span>,</span>
<span>                <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">carrying_capacity</span> <span class="op">*</span> <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">$</span><span class="va">climate_suitability</span></span>
<span>            <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    execution_priority <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; adding process: reproduction</span></span>
<span><span class="co">#&gt; to species:</span></span>
<span><span class="co">#&gt; [1] "species_1" "species_2"</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>Now we add the two methods of dispersal to the two species to
highlight the difference.</p>
</div>
<div class="section level2">
<h2 id="unweighted-dispersal">Unweighted dispersal<a class="anchor" aria-label="anchor" href="#unweighted-dispersal"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span><span class="op">$</span><span class="fu">add_process</span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="st">"species_1"</span>,</span>
<span>    process_name <span class="op">=</span> <span class="st">"dispersal_process"</span>,</span>
<span>    process_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">[[</span><span class="st">"abundance"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span></span>
<span>            abundance <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">[[</span><span class="st">"abundance"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            dispersal_kernel <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">[[</span><span class="st">"dispersal_kernel"</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    execution_priority <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; adding process: dispersal_process</span></span>
<span><span class="co">#&gt; to species:</span></span>
<span><span class="co">#&gt; [1] "species_1"</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="weighted-dispersal">Weighted dispersal<a class="anchor" aria-label="anchor" href="#weighted-dispersal"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span><span class="op">$</span><span class="fu">add_process</span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="st">"species_2"</span>,</span>
<span>    process_name <span class="op">=</span> <span class="st">"dispersal_process"</span>,</span>
<span>    process_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">[[</span><span class="st">"abundance"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dispersal.html">dispersal</a></span><span class="op">(</span></span>
<span>            abundance <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">[[</span><span class="st">"abundance"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            dispersal_kernel <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">[[</span><span class="st">"dispersal_kernel"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>            weights <span class="op">=</span> <span class="va">self</span><span class="op">$</span><span class="va">traits</span><span class="op">[[</span><span class="st">"climate_suitability"</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    execution_priority <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; adding process: dispersal_process</span></span>
<span><span class="co">#&gt; to species:</span></span>
<span><span class="co">#&gt; [1] "species_2"</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-of-the-results">Comparison of the results<a class="anchor" aria-label="anchor" href="#comparison-of-the-results"></a>
</h2>
<p>To see the effect, we run the simulation for 10 time steps and plot
the results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_verbosity.html">set_verbosity</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="fu">begin</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"Purple-Yellow"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, <span class="st">"species_1"</span>, <span class="st">"abundance"</span>, col <span class="op">=</span> <span class="va">plot_cols</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="A04_dispersal_files/figure-html/run_sim-1.png" alt="Figure 2: Resulting abundance of species 1 (with unweighted dispersal) after 10 time steps." width="700"><p class="caption">
Figure 2: Resulting abundance of species 1 (with unweighted dispersal)
after 10 time steps.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, <span class="st">"species_2"</span>, <span class="st">"abundance"</span>, col <span class="op">=</span> <span class="va">plot_cols</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="A04_dispersal_files/figure-html/run_sim2-1.png" alt="Figure 3: Resulting abundance of species 2 (with weighted dispersal) after 10 time steps." width="700"><p class="caption">
Figure 3: Resulting abundance of species 2 (with weighted dispersal)
after 10 time steps.
</p>
</div>
<p>Note how the plot for species two is less “blurry” and the different
scales of the two plots. While the first species loses individuals by
dispersing into unsuitable habitat, the second species can keep a much
larger population size, by moving towards more suitable habitat during
dispersal.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Nathan, R., Klein, E., Robledo-Arnuncio, J.J. and Revilla, E. (2012)
Dispersal kernels: review. in: Dispersal Ecology and Evolution
pp. 187–210. (eds J. Clobert, M. Baguette, T.G. Benton and J.M.
Bullock), Oxford, UK: Oxford Academic, 2013. <a href="doi:10.1093/acprof:oso/9780199608898.003.0015" class="uri">doi:10.1093/acprof:oso/9780199608898.003.0015</a>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stefan Fallert, Lea Li, Juliano Sarmento Cabral, Bavarian Ministry of Science and Arts (bayklif), Deutsche Bundesstiftung Umwelt (DBU).</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
